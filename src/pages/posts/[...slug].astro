---
import "../../styles/global.css";
import { getCollection, getEntry } from "astro:content";
import { AstroError } from "astro/errors";
import Header from "../../components/header";
import MainLayout from "../../layouts/MainLayout.astro";

// ðŸ” This tells Astro what slugs to render
export async function getStaticPaths() {
  const posts = await getCollection("posts");

  return posts.map((post) => ({
    params: { slug: post.slug },
  }));
}

// ðŸ‘‡ Get the slug from the URL
const { slug } = Astro.params;
const post = await getEntry("posts", slug);

if (!post) throw new AstroError("Post not found");

const { Content } = await post.render();
---

<MainLayout>
  <h1 class="text-2xl font-bold mb-4">{post.data.title}</h1>
  <p class="text-gray-500 mb-4"><em>{post.data.pubDate.toDateString()}</em></p>

  <article class="prose max-w-none">
    <Content />
  </article>
</MainLayout>
